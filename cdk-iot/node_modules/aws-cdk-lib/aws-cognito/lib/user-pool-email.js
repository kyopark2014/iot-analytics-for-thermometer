"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserPoolEmail=void 0;const jsiiDeprecationWarnings=require("../../.warnings.jsii.js"),JSII_RTTI_SYMBOL_1=Symbol.for("jsii.rtti"),core_1=require("../../core"),punycode_1=require("punycode/");class UserPoolEmail{static withCognito(replyTo){return new CognitoEmail(replyTo)}static withSES(options){try{jsiiDeprecationWarnings.aws_cdk_lib_aws_cognito_UserPoolSESOptions(options)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,this.withSES),error}return new SESEmail(options)}}exports.UserPoolEmail=UserPoolEmail,_a=JSII_RTTI_SYMBOL_1,UserPoolEmail[_a]={fqn:"aws-cdk-lib.aws_cognito.UserPoolEmail",version:"2.23.0"};class CognitoEmail extends UserPoolEmail{constructor(replyTo){super(),this.replyTo=replyTo}_bind(_scope){return{replyToEmailAddress:encodeAndTest(this.replyTo),emailSendingAccount:"COGNITO_DEFAULT"}}}class SESEmail extends UserPoolEmail{constructor(options){super(),this.options=options}_bind(scope){var _b,_c;const region=core_1.Stack.of(scope).region;if(core_1.Token.isUnresolved(region)&&!this.options.sesRegion)throw new Error('Your stack region cannot be determined so "sesRegion" is required in SESOptions');let from=this.options.fromEmail;if(this.options.fromName&&(from=`${this.options.fromName} <${this.options.fromEmail}>`),this.options.sesVerifiedDomain&&this.options.fromEmail.split("@").pop()!==this.options.sesVerifiedDomain)throw new Error('"fromEmail" contains a different domain than the "sesVerifiedDomain"');return{from:encodeAndTest(from),replyToEmailAddress:encodeAndTest(this.options.replyTo),configurationSet:this.options.configurationSetName,emailSendingAccount:"DEVELOPER",sourceArn:core_1.Stack.of(scope).formatArn({service:"ses",resource:"identity",resourceName:encodeAndTest((_b=this.options.sesVerifiedDomain)!==null&&_b!==void 0?_b:this.options.fromEmail),region:(_c=this.options.sesRegion)!==null&&_c!==void 0?_c:region})}}}function encodeAndTest(input){if(input){const local=input.split("@")[0];if(!/[\p{ASCII}]+/u.test(local))throw new Error("the local part of the email address must use ASCII characters only");return punycode_1.toASCII(input)}else return}
//# sourceMappingURL=user-pool-email.js.map
